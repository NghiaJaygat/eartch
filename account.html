<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Qu·∫£n l√Ω T√†i kho·∫£n</title>
<link rel="stylesheet" href="style.css" />
<link rel="stylesheet" href="home.css" />
<body>
  <div class="container">
    <h1>üë§ Qu·∫£n l√Ω T√†i kho·∫£n</h1>
    <div class="card">
      <h2>Th√¥ng tin c√° nh√¢n</h2>
      <p><strong>T√™n ng∆∞·ªùi d√πng:</strong> <span id="accountUsername"></span></p>
      <p><strong>ƒêi·ªÉm c·ªông:</strong> <span id="accountPoints"></span></p>

      <h3>C·∫≠p nh·∫≠t t√™n ng∆∞·ªùi d√πng</h3>
      <label for="newUsername">T√™n ng∆∞·ªùi d√πng m·ªõi:</label>
      <input type="text" id="newUsername" placeholder="Nh·∫≠p t√™n ng∆∞·ªùi d√πng m·ªõi" />
      <button onclick="updateUsername()">C·∫≠p nh·∫≠t t√™n</button>
      <p id="usernameUpdateMessage" style="color: green;"></p>

      <h3>ƒê·ªïi m·∫≠t kh·∫©u</h3>
      <label for="currentPassword">M·∫≠t kh·∫©u hi·ªán t·∫°i:</label>
      <input type="password" id="currentPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u hi·ªán t·∫°i" />
      <br><br>
      <label for="newPassword">M·∫≠t kh·∫©u m·ªõi:</label>
      <input type="password" id="newPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi" />
      <br><br>
      <label for="confirmNewPassword">X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi:</label>
      <input type="password" id="confirmNewPassword" placeholder="X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi" />
      <button onclick="changePassword()">ƒê·ªïi m·∫≠t kh·∫©u</button>
      <p id="passwordUpdateMessage" style="color: green;"></p>
    </div>
    <a href="home.html" class="btn-primary">üîô Quay l·∫°i trang ch·ªß</a>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const username = localStorage.getItem("username") || "Kh√°ch";
      const points = localStorage.getItem("userPoints") || 0;

      document.getElementById("accountUsername").textContent = username;
      document.getElementById("accountPoints").textContent = points;
    });

    function updateUsername() {
      const newUsernameInput = document.getElementById("newUsername");
      const newUsername = newUsernameInput.value.trim();
      const updateMessage = document.getElementById("usernameUpdateMessage");

      if (newUsername) {
        localStorage.setItem("username", newUsername);
        document.getElementById("accountUsername").textContent = newUsername;
        updateMessage.textContent = "C·∫≠p nh·∫≠t t√™n ng∆∞·ªùi d√πng th√†nh c√¥ng!";
        updateMessage.style.color = "green";
        newUsernameInput.value = ""; // X√≥a tr∆∞·ªùng nh·∫≠p li·ªáu
      } else {
        updateMessage.textContent = "T√™n ng∆∞·ªùi d√πng kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng!";
        updateMessage.style.color = "red";
      }
    }

    function changePassword() {
      const currentPasswordInput = document.getElementById("currentPassword");
      const newPasswordInput = document.getElementById("newPassword");
      const confirmNewPasswordInput = document.getElementById("confirmNewPassword");
      const passwordUpdateMessage = document.getElementById("passwordUpdateMessage");

      const currentPassword = currentPasswordInput.value;
      const newPassword = newPasswordInput.value;
      const confirmNewPassword = confirmNewPasswordInput.value;

      // Trong m·ªôt ·ª©ng d·ª•ng th·ª±c t·∫ø, b·∫°n s·∫Ω g·ª≠i currentPassword ƒë·∫øn server ƒë·ªÉ x√°c th·ª±c
      // v√† sau ƒë√≥ hash newPassword tr∆∞·ªõc khi l∆∞u tr·ªØ.
      const storedPassword = localStorage.getItem("password"); // R·∫•t kh√¥ng an to√†n!

      if (!currentPassword || !newPassword || !confirmNewPassword) {
        passwordUpdateMessage.textContent = "Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß c√°c tr∆∞·ªùng!";
        passwordUpdateMessage.style.color = "red";
        return;
      }

      if (currentPassword !== storedPassword) { // So s√°nh tr·ª±c ti·∫øp, kh√¥ng an to√†n!
        passwordUpdateMessage.textContent = "M·∫≠t kh·∫©u hi·ªán t·∫°i kh√¥ng ƒë√∫ng.";
        passwordUpdateMessage.style.color = "red";
        return;
      }

      if (newPassword.length < 6) {
        passwordUpdateMessage.textContent = "M·∫≠t kh·∫©u m·ªõi ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±.";
        passwordUpdateMessage.style.color = "red";
        return;
      }

      if (newPassword !== confirmNewPassword) {
        passwordUpdateMessage.textContent = "M·∫≠t kh·∫©u m·ªõi v√† x√°c nh·∫≠n m·∫≠t kh·∫©u kh√¥ng kh·ªõp.";
        passwordUpdateMessage.style.color = "red";
        return;
      }

      // L∆∞u m·∫≠t kh·∫©u m·ªõi v√†o localStorage (R·∫§T KH√îNG AN TO√ÄN!)
      localStorage.setItem("password", newPassword);
      passwordUpdateMessage.textContent = "ƒê·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng!";
      passwordUpdateMessage.style.color = "green";

      // X√≥a c√°c tr∆∞·ªùng nh·∫≠p li·ªáu
      currentPasswordInput.value = "";
      newPasswordInput.value = "";
      confirmNewPasswordInput.value = "";
    }

    // H√†m ƒë·ªÉ tƒÉng ƒëi·ªÉm c·ªông (v√≠ d·ª•: khi ng∆∞·ªùi d√πng th·ª±c hi·ªán m·ªôt h√†nh ƒë·ªông n√†o ƒë√≥)
    function addPoints(amount) {
      let currentPoints = parseInt(localStorage.getItem("userPoints")) || 0;
      currentPoints += amount;
      localStorage.setItem("userPoints", currentPoints);
      document.getElementById("accountPoints").textContent = currentPoints; // C·∫≠p nh·∫≠t hi·ªÉn th·ªã
      console.log(`ƒê√£ th√™m ${amount} ƒëi·ªÉm. T·ªïng ƒëi·ªÉm: ${currentPoints}`);
    }

    // V√≠ d·ª•: B·∫°n c√≥ th·ªÉ g·ªçi addPoints(10) t·ª´ m·ªôt n∆°i kh√°c trong ·ª©ng d·ª•ng khi ng∆∞·ªùi d√πng ho√†n th√†nh m·ªôt nhi·ªám v·ª•.
  </script>
</body>
</html>